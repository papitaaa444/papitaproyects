<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title> PapitaWebğŸŒ¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --rosa:#FF69B4; --rosa-claro:#FFB6C1; --magenta:#DB7093; --bg:#FFF0F5;
      --oscuro:#0b132b; --azul:#00d4ff; --verde:#1DB954; --gris:#1a1a1a; --oro:#FFD700;
    }
    * { box-sizing: border-box; }
    body { margin:0; font-family: Georgia, serif; background: var(--bg); color:#333; }
    .pantalla { display:none; padding:26px; text-align:center; min-height:100vh; }
    .btn { margin:10px; padding:12px 20px; border:none; border-radius:10px; font-weight:bold; cursor:pointer; }
    .btn-primario { background: var(--rosa); color: white; }
    .btn-rosa { background: var(--rosa-claro); color:white; }
    .btn-verde { background: var(--verde); color:white; }
    .btn-azul { background: var(--azul); color:black; }
    canvas { border:2px solid #ffc0cb; background:white; border-radius:8px; max-width: 100%; cursor: crosshair; }
    input { padding:10px; font-size:16px; border:2px solid #eee; border-radius:8px; text-align:center; }
    #juego3 { background: var(--oscuro); color:white; }
    #juego4 { background:#0d1b2a; color:white; }
    #juego5 { background:#FFF5EE; }
    #juego6 { background:#FFF9FB; }
    #juego7 { background:#121212; color:white; }
    #juego8 { background: var(--gris); color:white; }
    #juego10 { background:#000014; color:white; }
    #cartaFinal { background:#FFFAF0; }
    
    /* Estilo especÃ­fico para el llenado del corazÃ³n */
    #canvasFill { background: #fff; cursor: pointer; }
  </style>
</head>
<body>

<section id="bienvenida" class="pantalla" style="display:block;">
  <h1 style="color:var(--magenta)">Para mi persona favorita</h1>
  <p style="color:#BC8F8F">He preparado este pequeÃ±o rincÃ³n para ti.<br>Â¿Me permites mostrarte?</p>
  <button class="btn btn-rosa" onclick="mostrar('juego1')">Comenzar Viaje âœ¨</button>
</section>

<section id="juego1" class="pantalla">
  <h2 style="color:#CD5C5C">ğŸ’– Primer Reto: ExpresiÃ³n</h2>
  
  <div id="ronda1">
    <h3>Ronda 1: DibÃºjame algo lindo ğŸ¨</h3>
    <p style="font-size: 0.8em; color: #888;">Usa tu mouse o dedo para dibujar</p>
    <canvas id="canvasDibujo" width="600" height="300"></canvas>
    <br>
    <button class="btn btn-rosa" onclick="pasarRonda(1)">Siguiente â¡ï¸</button>
  </div>

  <div id="ronda2" style="display:none;">
    <h3>Ronda 2: Llena mi corazÃ³n de color â¤ï¸</h3>
    <p id="progresoTexto" style="color: var(--magenta);">0% lleno</p>
    <canvas id="canvasFill" width="600" height="400"></canvas>
    <br>
    <button id="btnNextRonda2" class="btn btn-rosa" style="display:none;" onclick="pasarRonda(2)">Siguiente â¡ï¸</button>
  </div>

  <div id="ronda3" style="display:none;">
    <h3>Busca 5 corazones rosados ğŸ’—</h3>
    <canvas id="canvasCorazones" width="600" height="350" style="background: transparent;"></canvas>
    <p id="puntos">Puntos: 0/5</p>
    <button id="btnNext1" class="btn btn-primario" style="display:none;" onclick="mostrar('juego2')">Siguiente â¡ï¸</button>
  </div>
</section>

<section id="juego2" class="pantalla">
  <h2 style="color:var(--magenta)">ğŸ¨ Encuentra el color oculto</h2>
  <p id="intentos">Te quedan 3 intentos</p>
  <div id="opciones"></div>
  <p id="mensaje" style="color:#F08080"></p>
</section>

<section id="juego3" class="pantalla">
  <h2>ğŸš€ Viaje Estelar (El Principito)</h2>
  <p id="frase"></p>
  <div id="opcionesPrincipito"></div>
  <p id="estado"></p>
</section>

<section id="juego4" class="pantalla">
  <h2>âœ¨ PROTEGE NUESTRO CIELO âœ¨</h2>
  <canvas id="canvasEsquiva" width="600" height="450" style="background:transparent;"></canvas>
  <p id="energia">EnergÃ­a del Amor: 0%</p>
</section>

<section id="juego5" class="pantalla">
  <h2>ğŸ’– Laberinto MÃ¡gico</h2>
  <p id="vidas">Vidas: â¤ï¸ â¤ï¸ â¤ï¸</p>
  <canvas id="canvasLaberinto" width="600" height="400" style="background:transparent;"></canvas>
</section>

<section id="juego6" class="pantalla">
  <h2>ğŸŒ¸ JardÃ­n Final ğŸŒ¸</h2>
  <canvas id="canvasJardin" width="800" height="650"></canvas>
  <br><button class="btn btn-primario" onclick="mostrar('juego7')">Continuar â¡ï¸</button>
</section>

<section id="juego7" class="pantalla">
  <h2>ğŸµ Trivia Musical ğŸµ</h2>
  <p id="pregunta"></p>
  <div id="opcionesTrivia"></div>
</section>

<section id="juego8" class="pantalla">
  <h2>ğŸ¤ Completa la letra ğŸ¤</h2>
  <p id="tituloLetra" style="font-style:italic; color:#cccccc"></p>
  <p id="fraseLetra" style="font-weight:bold"></p>
  <div id="opcionesLetra"></div>
</section>

<section id="juego9" class="pantalla">
  <h2>ğŸ•µï¸ Adivina el Artista por Emojis</h2>
  <p id="emojiArtista" style="font-size:40px;"></p>
  <input id="entradaArtista" type="text" placeholder="Escribe tu respuesta..." />
  <button class="btn btn-verde" onclick="verificarArtista()">Comprobar</button>
  <p id="errorArtista" style="color:red;"></p>
</section>

<section id="juego10" class="pantalla">
  <h2 style="color:var(--oro)">ğŸ‰ Â¡Felicidades! ğŸ‰</h2>
  <div style="background: rgba(219, 112, 147, 0.2); padding: 15px; border-radius: 15px; margin-bottom: 20px; border: 1px solid var(--rosa); max-width: 500px; margin-left: auto; margin-right: auto;">
    <p style="color: #FFB6C1; font-style: italic; margin-bottom: 10px;">
      "Estos pequeÃ±os retos eran para mostrarte 5 canciones que me recuerdan a ti"
    </p>
    <ul style="list-style: none; padding: 0; color: white; text-align: left; display: inline-block; font-family: sans-serif; font-size: 0.9em;">
      <li>1. ğŸµ The Boy Is Mine - Ariana Grande</li>
      <li>2. ğŸµ Lo Que Siento - Cuco</li>
      <li>3. ğŸµ Te AmarÃ© - Silvio RodrÃ­guez</li>
      <li>4. ğŸµ Obsesionado - Farruko (con Alexio La Bestia)</li>
      <li>5. ğŸµ Die With A Smile - Lady Gaga y Bruno Mars</li>
    </ul>
  </div>
  <canvas id="canvasFuegos" width="800" height="400" style="background:#000014; border-color:#222;"></canvas>
  <br><button class="btn btn-rosa" onclick="mostrar('cartaFinal')">Abrir Carta Especial ğŸ’Œ</button>
</section>

<section id="cartaFinal" class="pantalla">
  <h2 style="color:var(--magenta); margin-bottom:12px;">Mi Carta Especial...</h2>
  <div style="position:relative; max-width:860px; margin:0 auto;">
    <canvas id="canvasCarta" width="820" height="520" style="background:#FFFAF0; border:none; border-radius:12px;"></canvas>
    <div style="position:absolute; left:50%; top:50%; transform:translate(-50%, -50%); width:620px; max-width:92%; background:#FFEFF4; border:2px solid #FFC0CB; border-radius:12px; box-shadow:0 10px 25px rgba(219,112,147,0.25); color:#505050; text-align:center; padding:22px;">
      <h3 style="margin:0 0 12px; color:#DB7093; font-family:Georgia, serif;">Mi carta especial...</h3>
      <div style="font-family:Verdana, sans-serif; font-size:14px; line-height:1.6; text-align:justify; color:#505050; max-height:280px; overflow:auto;">
        QuizÃ¡ te demuestro muy poco y quizÃ¡ esto no sea nada o, si lo es, no sea suficiente. No es que no quiera expresar o mostrar todo lo que siento.
        Realmente, hay muchas cosas que siento y que quisiera expresar, pero creo que de verdad me quedo corta, jajaja, irÃ³nico Â¿cierto?
        Haciendo esto cayeron varias de mis lÃ¡grimas, no lo voy a negar. Muchas cosas me asustan y, entre esas, que me destrocen, porque una vez ya lleguÃ© a eso.
        Al menos, si llego a caer ahÃ­ otra vez, que no sea por ti, por favor. Quiero algo bonito e igual siento que quizÃ¡ si no funciona pueda ser porque soy yo el problema.
        Siendo asÃ­, te pido disculpas, quizÃ¡ por el miedo a llorar me limitÃ© a ciertas cosas. Bueno, pero quiero que sepas que hay muchos sentimientos,
        muchas emociones que me haces sentir. Me haces feliz y quiero poder hacerte igual de feliz. Gracias por estar y por aguantarme.
        SÃ© que me pongo tonta y sigo mejorando por ti para ser y poder entregarte lo mejor. Â¡Muakkkk!
      </div>
      <button class="btn btn-primario" style="margin-top:14px;" onclick="finalizarCarta()">Finalizar con un abrazo virtual ğŸ¤—</button>
    </div>
  </div>
</section>

<script>
// NAVEGACIÃ“N
function mostrar(id){
  document.querySelectorAll('.pantalla').forEach(p=>p.style.display='none');
  const el = document.getElementById(id);
  if(el) el.style.display='block';
}

function pasarRonda(n){
  if(n===1){ document.getElementById("ronda1").style.display="none"; document.getElementById("ronda2").style.display="block"; iniciarRonda2(); }
  if(n===2){ document.getElementById("ronda2").style.display="none"; document.getElementById("ronda3").style.display="block"; }
}

// --- RONDA 1: DIBUJO ---
const canvaDibujo = document.getElementById("canvasDibujo"), ctxDibujo = canvaDibujo.getContext("2d");
let dibujando = false;
ctxDibujo.strokeStyle = "#DB7093"; ctxDibujo.lineWidth = 3; ctxDibujo.lineCap = "round";

function getPos(e, canvas) {
  const rect = canvas.getBoundingClientRect();
  const clientX = e.touches ? e.touches[0].clientX : e.clientX;
  const clientY = e.touches ? e.touches[0].clientY : e.clientY;
  return { x: clientX - rect.left, y: clientY - rect.top };
}

canvaDibujo.addEventListener("mousedown", (e) => { dibujando = true; const p = getPos(e, canvaDibujo); ctxDibujo.beginPath(); ctxDibujo.moveTo(p.x, p.y); });
canvaDibujo.addEventListener("mousemove", (e) => { if(!dibujando) return; const p = getPos(e, canvaDibujo); ctxDibujo.lineTo(p.x, p.y); ctxDibujo.stroke(); });
canvaDibujo.addEventListener("mouseup", () => dibujando = false);
// Soporte tÃ¡ctil
canvaDibujo.addEventListener("touchstart", (e) => { e.preventDefault(); dibujando = true; const p = getPos(e, canvaDibujo); ctxDibujo.beginPath(); ctxDibujo.moveTo(p.x, p.y); });
canvaDibujo.addEventListener("touchmove", (e) => { e.preventDefault(); if(!dibujando) return; const p = getPos(e, canvaDibujo); ctxDibujo.lineTo(p.x, p.y); ctxDibujo.stroke(); });
canvaDibujo.addEventListener("touchend", () => dibujando = false);

// --- RONDA 2: RELLENAR CORAZÃ“N (CORREGIDO) ---
const canvaFill = document.getElementById("canvasFill"), ctxFill = canvaFill.getContext("2d");
let pixelesCorazon = 0;

function iniciarRonda2() {
  // Limpiar y preparar
  ctxFill.clearRect(0,0,600,400);
  ctxFill.fillStyle = "#e0e0e0"; // Gris claro para el fondo del corazÃ³n
  ctxFill.font = "400px Arial";
  ctxFill.textAlign = "center";
  ctxFill.textBaseline = "middle";
  ctxFill.fillText("â¤", 300, 220);
  
  // Contar exactamente cuÃ¡ntos pÃ­xeles ocupa el corazÃ³n gris
  const imgData = ctxFill.getImageData(0,0,600,400);
  pixelesCorazon = 0;
  for(let i=0; i<imgData.data.length; i+=4) {
    if(imgData.data[i] < 255) pixelesCorazon++; 
  }
}

function paint(e) {
  const p = getPos(e, canvaFill);
  
  // Solo permite pintar "dentro" del corazÃ³n gris
  ctxFill.globalCompositeOperation = "source-atop";
  ctxFill.fillStyle = "#FF69B4";
  ctxFill.beginPath();
  ctxFill.arc(p.x, p.y, 35, 0, Math.PI*2); // Pincel mÃ¡s grande
  ctxFill.fill();
  
  // Calcular progreso real
  const imgData = ctxFill.getImageData(0,0,600,400);
  let pintadosRosa = 0;
  for(let i=0; i<imgData.data.length; i+=4) {
    // Si el pÃ­xel es Rosa (R:255, G:105, B:180)
    if(imgData.data[i] === 255 && imgData.data[i+1] === 105) {
      pintadosRosa++;
    }
  }
  
  // El porcentaje ahora es sobre el Ã¡rea del corazÃ³n, no del canvas
  let porc = Math.min(100, Math.floor((pintadosRosa / pixelesCorazon) * 100));
  
  // Ajuste de sensibilidad: al 75% ya se ve bastante lleno y damos por bueno
  document.getElementById("progresoTexto").innerText = porc + "% lleno";
  if(porc >= 75) {
    document.getElementById("progresoTexto").innerText = "Â¡100% LLENO DE AMOR! â¤ï¸";
    document.getElementById("btnNextRonda2").style.display = "inline-block";
  }
}

canvaFill.addEventListener("mousedown", (e) => { canvaFill._isDrawing = true; paint(e); });
canvaFill.addEventListener("mousemove", (e) => { if(canvaFill._isDrawing) paint(e); });
window.addEventListener("mouseup", () => { canvaFill._isDrawing = false; });

canvaFill.addEventListener("touchstart", (e) => { e.preventDefault(); paint(e); });
canvaFill.addEventListener("touchmove", (e) => { e.preventDefault(); paint(e); });
// --- REUTILIZACIÃ“N DE LÃ“GICA ORIGINAL PARA RONDA 3 Y DEMÃS ---
// (He mantenido tu lÃ³gica de la Ronda 3, Colores, El Principito, etc., intacta)

// Ronda 3
const c3 = document.getElementById("canvasCorazones"), ctx3 = c3.getContext("2d");
let puntos=0, arr=[], spawnTimeout=null;
function drawR3(){ ctx3.clearRect(0,0,c3.width,c3.height); ctx3.font="36px Arial"; arr.forEach(c=>ctx3.fillText(c.t,c.x,c.y)); }
function spawnR3(){ if(puntos>=5) return; const x=Math.random()*560+20, y=Math.random()*320+20; arr.push({x,y,t:["â¤ï¸","ğŸ’œ","ğŸ’—","ğŸŒ¸","âœ¨"][(Math.random()*5)|0]}); drawR3(); spawnTimeout = setTimeout(spawnR3, 250); }
c3.addEventListener("click",(e)=>{ const r=c3.getBoundingClientRect(); const x=e.clientX-r.left, y=e.clientY-r.top; let closest=-1, best=9999; arr.forEach((c,i)=>{const d=Math.hypot(x-c.x,y-c.y+20); if(d<best){best=d; closest=i;}}); if(closest!==-1 && best<40){ if(arr[closest].t==="ğŸ’—"){ puntos++; document.getElementById("puntos").innerText=`Puntos: ${puntos}/5`; if(puntos>=5){ document.getElementById("btnNext1").style.display="inline-block"; clearTimeout(spawnTimeout); } } arr.splice(closest,1); drawR3(); } });
const obsJ1 = new MutationObserver(()=>{ if(document.getElementById("ronda3").style.display==="block"){ puntos=0; arr=[]; spawnR3(); } });
obsJ1.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});

// Juego 2: Colores
(function(){
  const intentosLbl = document.getElementById("intentos"), opcionesDiv = document.getElementById("opciones"), msg = document.getElementById("mensaje");
  let intentos = 3;
  const opciones = [{n:"Azul", c:"#ADD8E6"}, {n:"Rojo", c:"#FFB2B2"}, {n:"Verde", c:"#C2F0C2"}, {n:"Amarillo", c:"#FFFFE0"}];
  opcionesDiv.innerHTML = opciones.map(o => `<button class="btn" style="background:${o.c}; width:120px;" onclick="verificarColor('${o.n}')">${o.n}</button>`).join("");
  window.verificarColor = (elegido) => { intentos--; if(intentos>0){ msg.innerText = ["Â¿Azul como el mar? No creo... ğŸŒŠ", "El rojo es lindo, pero Â¿es ese? â¤ï¸", "Verde esperanza... pero esperanza de ganar ğŸŒ¿"][(Math.random()*3)|0]; intentosLbl.innerText = `Te quedan ${intentos} intentos`; } else { opcionesDiv.innerHTML = ""; intentosLbl.innerText = "Â¡Se acabaron los intentos! ğŸ¤­"; const btn = document.createElement("button"); btn.className="btn btn-rosa"; btn.textContent = "Tap tap aquÃ­, te equivocaste, era el color de fondo ğŸ¤¡"; btn.onclick = () => { document.getElementById("juego2").innerHTML = `<h2 style="color:white; background:#FFC0CB; padding:50px; border-radius:12px;">Â¡Era obvio! El color era ROSADO ğŸ’—</h2><button class="btn btn-primario" onclick="mostrar('juego3')">Continuar âœ¨</button>`; }; opcionesDiv.appendChild(btn); } };
})();

// Juego 3: Principito
(function(){
  const frases = [{texto:"Lo esencial es invisible...", correcta:"a los ojos", opciones:["al corazÃ³n","a la mente","al alma"]}, {texto:"Fue el tiempo que pasaste con tu...", correcta:"rosa", opciones:["planeta","zorro","orgullo"]}, {texto:"Si vienes, por ejemplo, a las cuatro de la tarde...", correcta:"feliz", opciones:["puntual","inquieto","amigo"]}, {texto:"Todas las personas mayores fueron al principio...", correcta:"niÃ±os", opciones:["sabios","pequeÃ±os","soÃ±adores"]}];
  let idx = 0;
  function render(){ if(idx>=frases.length){ document.getElementById("juego3").innerHTML = `<h2 style="color:#ffca3a;">âœ¨ Â¡Sabias palabras! âœ¨</h2><button class="btn btn-azul" onclick="mostrar('juego4')">Continuar ğŸš€</button>`; return; } const f = frases[idx]; document.getElementById("frase").innerText = `"${f.texto}"`; const all = [...f.opciones, f.correcta].sort(()=>Math.random()-0.5); document.getElementById("opcionesPrincipito").innerHTML = all.map(o => `<button class="btn" style="background:#1c2541; color:white;" onclick="verificarPrincipito('${o}')">${o}</button>`).join(" "); }
  window.verificarPrincipito = (o)=>{ if(o===frases[idx].correcta){ idx++; render(); } else { document.getElementById("estado").innerText="âŒ Intenta de nuevo"; } };
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego3").style.display==="block") render(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 4: Esquiva
(function(){
  const canvas = document.getElementById("canvasEsquiva"), ctx = canvas.getContext("2d"), energiaLbl = document.getElementById("energia");
  const corazon = {x:300,y:350}; let obstaculos = [], rayos = [], puntos = 0, jugando = true;
  canvas.addEventListener("mousemove", (e)=>{ const r = canvas.getBoundingClientRect(); corazon.x = e.clientX - r.left; corazon.y = e.clientY - r.top; });
  function clima(){ if(!jugando) return; obstaculos.push({x:Math.random()*580+20, y:-50, tipo:["â˜ï¸","â›ˆï¸","â„ï¸"][(Math.random()*3)|0], vy:6+Math.random()*5, vx:(Math.random()*8-4)}); if(Math.random()<0.3) rayos.push({x:-50,y:Math.random()*350+50}); setTimeout(clima,220); }
  function frame(){ ctx.clearRect(0,0,600,450); ctx.font="28px Arial"; ctx.fillText("â¤ï¸",corazon.x,corazon.y); obstaculos.forEach(o=>{ ctx.font="35px Arial"; ctx.fillText(o.tipo,o.x,o.y); o.x+=o.vx; o.y+=o.vy; if(Math.abs(corazon.x-o.x)<35 && Math.abs(corazon.y-o.y)<35) puntos=Math.max(0,puntos-6); }); obstaculos = obstaculos.filter(o=>o.y<500); rayos.forEach(r=>{ ctx.font="30px Arial"; ctx.fillStyle="#ffd60a"; ctx.fillText("âš¡",r.x,r.y); ctx.fillStyle="black"; r.x+=15; if(Math.abs(corazon.x-r.x)<30 && Math.abs(corazon.y-r.y)<30) puntos=Math.max(0,puntos-15); }); puntos+=0.45; const energia = Math.min(100,puntos); energiaLbl.innerText = `EnergÃ­a del Amor: ${Math.floor(energia)}%`; if(energia>=100){ jugando=false; document.getElementById("juego4").innerHTML = `<h2>Â¡CIELO DESPEJADO! âœ¨</h2><button class="btn btn-azul" onclick="mostrar('juego5')">SIGUIENTE RETO â”</button>`; } else { requestAnimationFrame(frame); } }
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego4").style.display==="block"){ obstaculos=[]; rayos=[]; puntos=0; jugando=true; clima(); frame(); } });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 5: Laberinto
(function(){
  const canvas = document.getElementById("canvasLaberinto"), ctx = canvas.getContext("2d"), vidasLbl = document.getElementById("vidas");
  let jugador={x:30,y:40}, vidas=3, jugando=true; const meta={x:530,y:340,w:50,h:50};
  let muros=[{x:0,y:100,w:450,h:15,dir:1},{x:150,y:200,w:450,h:15,dir:-1},{x:0,y:300,w:450,h:15,dir:1}];
  let obst=[{x:300,y:150,vx:8,vy:3,t:"âœ¨"},{x:300,y:250,vx:-8,vy:-3,t:"ğŸ’«"}];
  canvas.addEventListener("mousemove",(e)=>{const r=canvas.getBoundingClientRect(); jugador.x=e.clientX-r.left; jugador.y=e.clientY-r.top;});
  function morir(){ vidas--; vidasLbl.innerText="Vidas: "+("â¤ï¸ ".repeat(vidas)); jugador.x=30; jugador.y=40; if(vidas<=0){ vidas=3; vidasLbl.innerText="Vidas: â¤ï¸ â¤ï¸ â¤ï¸"; } }
  function loop(){ if(!jugando) return; ctx.clearRect(0,0,600,400); ctx.fillStyle="#FF1493"; ctx.beginPath(); ctx.arc(meta.x+25,meta.y+25,25,0,Math.PI*2); ctx.fill(); ctx.font="22px Arial"; ctx.fillText("ğŸ’–",jugador.x,jugador.y); ctx.fillStyle="#FF69B4"; muros.forEach(m=>{ ctx.fillRect(m.x,m.y,m.w,m.h); m.w += 2*m.dir; if(m.w>550||m.w<350) m.dir*=-1; if(jugador.x>m.x && jugador.x<m.x+m.w && jugador.y>m.y && jugador.y<m.y+m.h) morir(); }); obst.forEach(o=>{ ctx.font="25px Arial"; ctx.fillText(o.t,o.x,o.y); o.x+=o.vx; o.y+=o.vy; if(o.x>580||o.x<20) o.vx*=-1; if(o.y>380||o.y<20) o.vy*=-1; if(Math.abs(jugador.x-o.x)<25 && Math.abs(jugador.y-o.y)<25) morir(); }); if(jugador.x>meta.x && jugador.x<meta.x+meta.w && jugador.y>meta.y && jugador.y<meta.y+meta.h){ jugando=false; document.getElementById("juego5").innerHTML = `<h2 style="color:#FF69B4">Â¡ERES INCREÃBLE! â¤ï¸</h2><button class="btn btn-primario" onclick="mostrar('juego6')">VER REGALO FINAL ğŸ</button>`; } else { requestAnimationFrame(loop); } }
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego5").style.display==="block"){ jugador={x:30,y:40}; vidas=3; jugando=true; loop(); } });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Juego 6: JardÃ­n
(function(){
  const canvas = document.getElementById("canvasJardin"), ctx = canvas.getContext("2d"), paleta=["#FFB6C1","#DB7093","#FF69B4","#FF1493","#FFC0CB"];
  function drawTulip(x,y,scale=1){ ctx.strokeStyle="#5FA66B"; ctx.lineWidth=3; ctx.beginPath(); ctx.moveTo(x, y); ctx.lineTo(x, y+100*scale); ctx.stroke(); ctx.fillStyle="#6FBF73"; ctx.beginPath(); ctx.ellipse(x-12, y+60, 20, 8, Math.PI/6, 0, Math.PI*2); ctx.fill(); ctx.beginPath(); ctx.ellipse(x+12, y+70, 20, 8, -Math.PI/6, 0, Math.PI*2); ctx.fill(); ctx.fillStyle = paleta[(Math.random()*5)|0]; ctx.beginPath(); ctx.moveTo(x, y); ctx.quadraticCurveTo(x-10*scale, y-30*scale, x, y-50*scale); ctx.quadraticCurveTo(x+10*scale, y-30*scale, x, y); ctx.fill(); ctx.beginPath(); ctx.moveTo(x, y); ctx.quadraticCurveTo(x-25*scale, y-25*scale, x-10*scale, y-50*scale); ctx.quadraticCurveTo(x-5*scale, y-25*scale, x, y); ctx.fill(); ctx.beginPath(); ctx.moveTo(x, y); ctx.quadraticCurveTo(x+25*scale, y-25*scale, x+10*scale, y-50*scale); ctx.quadraticCurveTo(x+5*scale, y-25*scale, x, y); ctx.fill(); }
  function escena(){ ctx.clearRect(0,0,800,650); ctx.fillStyle="#FFF9FB"; ctx.fillRect(0,0,800,650); ctx.fillStyle="#DB7093"; ctx.font="30px Georgia"; ctx.fillText("Para mi lugar seguro...",280,90); ctx.fillStyle="#BC8F8F"; ctx.font="16px Arial"; ctx.fillText("Eres lo mÃ¡s bonito de mi vida.",300,130); for(let i=0;i<25;i++){ drawTulip(Math.random()*700+50, Math.random()*140+420, 1+Math.random()*0.3); } }
  const petals=[]; function spawnPetal(){ petals.push({x:Math.random()*800, y:-20, size:12+Math.random()*10, vy:1.8+Math.random()*1.4, vx:(Math.random()*0.8-0.4)}); }
  function loop(){ escena(); petals.forEach(p=>{ ctx.font = `${p.size}px Arial`; ctx.fillText("ğŸŒ¸", p.x, p.y); p.y += p.vy; p.x += p.vx; }); for(let i=petals.length-1;i>=0;i--) if(petals[i].y>660) petals.splice(i,1); requestAnimationFrame(loop); }
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego6").style.display==="block"){ if(!window._petalInterval) window._petalInterval = setInterval(spawnPetal, 500); loop(); } });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Trivia
(function(){
  const preguntas = [{p:"Â¿QuiÃ©n es el 'Rey del Pop'?", c:"Michael Jackson", o:["Elvis Presley","Michael Jackson","Prince","Bruno Mars"]}, {p:"Â¿GÃ©nero de 'Bohemian Rhapsody'?", c:"Rock", o:["Pop","Jazz","Rock","Ã“pera"]}, {p:"Â¿'El Sol de MÃ©xico'?", c:"Luis Miguel", o:["Alejandro FernÃ¡ndez","Luis Miguel","Chayanne","Cristian Castro"]}]; let idx=0;
  function render(){ if(idx>=preguntas.length){ document.getElementById("juego7").innerHTML = `<h2 style="color:#1DB954">Â¡Trivia Completada! ğŸ¶</h2><button class="btn btn-verde" onclick="mostrar('juego8')">Continuar â¡ï¸</button>`; return; } document.getElementById("pregunta").innerText = preguntas[idx].p; document.getElementById("opcionesTrivia").innerHTML = preguntas[idx].o.map(opt => `<button class="btn" style="background:#282828; color:white;" onclick="verificarTrivia('${opt}')">${opt}</button>`).join(" "); }
  window.verificarTrivia = (o)=>{ if(o===preguntas[idx].c){ idx++; render(); } else { alert("âŒ Incorrecto"); } };
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego7").style.display==="block") render(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Completar letra
(function(){
  const retos = [{t:"Luis Miguel", l:"Si tÃº me hubieras dicho siempre la verdad...", c:"si hubieras respondido cuando te llamÃ©", o:["si no te hubieras ido de mi lado","si hubieras respondido cuando te llamÃ©","si me hubieras amado un poco mÃ¡s"]}, {t:"Coldplay", l:"Look at the stars...", c:"you", o:["us","me","you"]}]; let idx=0;
  function render(){ if(idx>=retos.length){ document.getElementById("juego8").innerHTML = `<h2 style="color:#FF4B2B">Â¡Reto Completado! ğŸ¶</h2><button class="btn btn-primario" onclick="mostrar('juego9')">Continuar â¡ï¸</button>`; return; } document.getElementById("tituloLetra").innerText = retos[idx].t; document.getElementById("fraseLetra").innerText = retos[idx].l; document.getElementById("opcionesLetra").innerHTML = retos[idx].o.map(o=>`<button class="btn" style="background:#333; color:white; width:320px;" onclick="verificarLetra('${o}')">${o}</button>`).join("<br/>"); }
  window.verificarLetra = (o)=>{ if(o===retos[idx].c){ idx++; render(); } else { alert("âŒ Incorrecto"); } };
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego8").style.display==="block") render(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Adivina Artista
(function(){
  const retos = [{emoji:"â˜€ï¸ ğŸ‡²ğŸ‡½ ğŸ™ï¸", c:"Luis Miguel"}, {emoji:"ğŸŒ™ ğŸ¤ ğŸ‘±ğŸ»â€â™€ï¸ ğŸ’…", c:"Ariana Grande"}, {emoji:"ğŸ¸ ğŸ© ğŸ”« ğŸŒ¹", c:"Guns N' Roses"}]; let idx=0;
  function render(){ if(idx>=retos.length){ document.getElementById("juego9").innerHTML = `<h2>ğŸ‰ Â¡Adivinaste todos! ğŸ‰</h2><button class="btn btn-primario" onclick="mostrar('juego10')">Continuar â¡ï¸</button>`; return; } document.getElementById("emojiArtista").innerText=retos[idx].emoji; }
  window.verificarArtista = ()=>{ if(document.getElementById("entradaArtista").value.trim().toLowerCase()===retos[idx].c.toLowerCase()){ idx++; render(); } else { alert("Casi!"); } };
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego9").style.display==="block") render(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Fuegos Artificiales
(function(){
  const canvas = document.getElementById("canvasFuegos"), ctx = canvas.getContext("2d"); let partes=[];
  function lanzar(){ const x=Math.random()*canvas.width, y=Math.random()*200+100; const color = ["#FFD700","#FF4500","#FF00FF","#00FFFF","#ADFF2F"][(Math.random()*5)|0]; for(let i=0;i<85;i++){ const ang = Math.random()*Math.PI*2; partes.push({x,y,vx:Math.cos(ang)*2.5, vy:Math.sin(ang)*2.5, vida:90, color, size:2}); } setTimeout(lanzar, 1200); }
  function loop(){ ctx.fillStyle="rgba(0,0,20,0.2)"; ctx.fillRect(0,0,canvas.width,canvas.height); partes.forEach(p=>{ ctx.fillStyle=p.color; ctx.beginPath(); ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fill(); p.x+=p.vx; p.y+=p.vy; p.vy+=0.02; p.vida--; }); partes = partes.filter(p=>p.vida>0); requestAnimationFrame(loop); }
  const obs = new MutationObserver(()=>{ if(document.getElementById("juego10").style.display==="block"){ lanzar(); loop(); } });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();

// Carta Final
(function(){
  const canvas = document.getElementById("canvasCarta"), ctx = canvas.getContext("2d"); let hearts=[], ticker, spawnInt;
  function newHeart(){ hearts.push({x:Math.random()*canvas.width, y:canvas.height+20, size:18+Math.random()*12, vx:(Math.random()*1-0.5), vy:-(1.2+Math.random()*1.8), col:["#FFB6C1","#FFC0CB","#DB7093"][(Math.random()*3)|0]}); }
  function loop(){ ctx.clearRect(0,0,canvas.width,canvas.height); hearts.forEach((c,i)=>{ c.x+=c.vx; c.y+=c.vy; ctx.font=`${c.size}px Arial`; ctx.fillStyle=c.col; ctx.fillText("ğŸ’—",c.x,c.y); if(c.y<-40) hearts.splice(i,1); }); ticker = requestAnimationFrame(loop); }
  function start(){ hearts=[]; for(let i=0; i<28; i++){ newHeart(); } loop(); spawnInt = setInterval(newHeart, 1200); }
  function stop(){ cancelAnimationFrame(ticker); clearInterval(spawnInt); }
  window.finalizarCarta = ()=>{ stop(); document.getElementById("cartaFinal").innerHTML = `<h2>Gracias por leer ğŸ’Œ</h2><button class="btn btn-rosa" onclick="location.reload()">Inicio</button>`; };
  const obs = new MutationObserver(()=>{ if(document.getElementById("cartaFinal").style.display==="block") start(); else stop(); });
  obs.observe(document.body,{attributes:true, subtree:true, attributeFilter:["style"]});
})();
</script>
</body>
</html>

